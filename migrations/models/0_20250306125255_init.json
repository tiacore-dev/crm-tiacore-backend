{
  "upgrade": [
    "CREATE TABLE IF NOT EXISTS \"companies\" (\n    \"company_id\" UUID NOT NULL PRIMARY KEY,\n    \"company_name\" VARCHAR(255) NOT NULL,\n    \"description\" TEXT\n);\nCREATE TABLE IF NOT EXISTS \"contract_statuses\" (\n    \"contract_status_id\" VARCHAR(255) NOT NULL PRIMARY KEY,\n    \"status_name\" VARCHAR(255) NOT NULL\n);\nCREATE TABLE IF NOT EXISTS \"legal_entity_types\" (\n    \"legal_entity_type_id\" VARCHAR(255) NOT NULL PRIMARY KEY,\n    \"entity_name\" VARCHAR(255) NOT NULL\n);\nCREATE TABLE IF NOT EXISTS \"legal_entities\" (\n    \"legal_entity_id\" UUID NOT NULL PRIMARY KEY,\n    \"legal_entity_name\" VARCHAR(255) NOT NULL,\n    \"inn\" VARCHAR(12) NOT NULL UNIQUE,\n    \"kpp\" VARCHAR(9),\n    \"vat_rate\" INT NOT NULL,\n    \"address\" VARCHAR(255) NOT NULL,\n    \"signer\" VARCHAR(255),\n    \"description\" TEXT,\n    \"company_id\" UUID NOT NULL REFERENCES \"companies\" (\"company_id\") ON DELETE CASCADE,\n    \"entity_type_id\" VARCHAR(255) NOT NULL REFERENCES \"legal_entity_types\" (\"legal_entity_type_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"bank_accounts\" (\n    \"bank_account_id\" UUID NOT NULL PRIMARY KEY,\n    \"account_number\" VARCHAR(20) NOT NULL,\n    \"bank_name\" VARCHAR(255) NOT NULL,\n    \"bank_bic\" VARCHAR(9) NOT NULL,\n    \"bank_corr_account\" VARCHAR(20) NOT NULL,\n    \"legal_entity_id\" UUID NOT NULL REFERENCES \"legal_entities\" (\"legal_entity_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"contracts\" (\n    \"contract_id\" UUID NOT NULL PRIMARY KEY,\n    \"contract_name\" VARCHAR(255) NOT NULL,\n    \"contract_date\" BIGINT NOT NULL,\n    \"comment\" TEXT,\n    \"file\" VARCHAR(2083),\n    \"buyer_id\" UUID NOT NULL REFERENCES \"legal_entities\" (\"legal_entity_id\") ON DELETE CASCADE,\n    \"seller_id\" UUID NOT NULL REFERENCES \"legal_entities\" (\"legal_entity_id\") ON DELETE CASCADE,\n    \"status_id\" VARCHAR(255) NOT NULL REFERENCES \"contract_statuses\" (\"contract_status_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"acts\" (\n    \"act_id\" UUID NOT NULL PRIMARY KEY,\n    \"act_number\" VARCHAR(255) NOT NULL,\n    \"act_date\" BIGINT NOT NULL,\n    \"contract_id\" UUID NOT NULL REFERENCES \"contracts\" (\"contract_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"bills\" (\n    \"bill_id\" UUID NOT NULL PRIMARY KEY,\n    \"bill_number\" VARCHAR(255) NOT NULL,\n    \"bill_date\" BIGINT NOT NULL,\n    \"bank_account_id\" UUID NOT NULL REFERENCES \"bank_accounts\" (\"bank_account_id\") ON DELETE CASCADE,\n    \"contract_id\" UUID NOT NULL REFERENCES \"contracts\" (\"contract_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"services\" (\n    \"service_id\" UUID NOT NULL PRIMARY KEY,\n    \"service_name\" VARCHAR(255) NOT NULL\n);\nCREATE TABLE IF NOT EXISTS \"act_details\" (\n    \"act_detail_id\" UUID NOT NULL PRIMARY KEY,\n    \"quantity\" DECIMAL(8,3) NOT NULL,\n    \"summ\" DECIMAL(10,2) NOT NULL,\n    \"act_id\" UUID NOT NULL REFERENCES \"acts\" (\"act_id\") ON DELETE CASCADE,\n    \"service_id\" UUID NOT NULL REFERENCES \"services\" (\"service_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"bill_details\" (\n    \"bill_detail_id\" UUID NOT NULL PRIMARY KEY,\n    \"quantity\" DECIMAL(8,3) NOT NULL,\n    \"summ\" DECIMAL(10,2) NOT NULL,\n    \"bill_id\" UUID NOT NULL REFERENCES \"bills\" (\"bill_id\") ON DELETE CASCADE,\n    \"service_id\" UUID NOT NULL REFERENCES \"services\" (\"service_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"users\" (\n    \"user_id\" UUID NOT NULL PRIMARY KEY,\n    \"user_name\" VARCHAR(255) NOT NULL UNIQUE,\n    \"password_hash\" VARCHAR(255) NOT NULL,\n    \"full_name\" VARCHAR(255) NOT NULL,\n    \"position\" VARCHAR(255)\n);\nCREATE TABLE IF NOT EXISTS \"user_roles\" (\n    \"role_id\" VARCHAR(255) NOT NULL PRIMARY KEY,\n    \"role_name\" VARCHAR(255) NOT NULL\n);\nCREATE TABLE IF NOT EXISTS \"user_to_company_relations\" (\n    \"user_company_id\" UUID NOT NULL PRIMARY KEY,\n    \"company_id\" UUID NOT NULL REFERENCES \"companies\" (\"company_id\") ON DELETE CASCADE,\n    \"role_id\" VARCHAR(255) NOT NULL REFERENCES \"user_roles\" (\"role_id\") ON DELETE CASCADE,\n    \"user_id\" UUID NOT NULL REFERENCES \"users\" (\"user_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"aerich\" (\n    \"id\" SERIAL NOT NULL PRIMARY KEY,\n    \"version\" VARCHAR(255) NOT NULL,\n    \"app\" VARCHAR(20) NOT NULL\n);"
  ]
}